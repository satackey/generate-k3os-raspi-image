{
    "builders": [
        {
            "type": "arm",
            "file_urls" : ["file:///images/ubuntu-20.04-preinstalled-server-arm64+raspi.img"],
            "file_checksum_type": "none",
            "file_target_extension": "img",
            "image_build_method": "reuse",
            "image_path": "k3os-ubuntu-overlay.img",
            "image_size": "4G",
            "image_type": "dos",
            "image_partitions": [
                {
                    "name": "boot",
                    "type": "c",
                    "start_sector": "2048",
                    "filesystem": "vfat",
                    "size": "524288",
                    "mountpoint": "/boot"
                },
                {
                    "name": "root",
                    "type": "83",
                    "start_sector": "526336",
                    "filesystem": "ext4",
                    "size": "5729104",
                    "mountpoint": "/"
                }
            ],
            "image_chroot_env": ["PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin"],
            "qemu_binary_source_path": "/usr/bin/qemu-arm-static",
            "qemu_binary_destination_path": "/usr/bin/qemu-arm-static"
        }
    ],
    "provisioners": [

        {
            "type": "file",
            "source": "/images/k3os-rootfs-arm.tar.gz",
            "destination": "/root/k3os-rootfs-arm.tar.gz"
        },
        {
            "type": "shell",
            "inline": [
                "set -x",
                "tar xzvf /root/k3os-rootfs-arm.tar.gz --strip-components=1 -C /",
                "rm -f /root/k3os-rootfs-arm.tar.gz",
                "sync"
            ]
        },
        {
            "type": "file",
            "source": "./k3os-system-config.yaml",
            "destination": "/k3os/system/config.yaml"
        }
    ]
}
